from pyrogram import filters

import database.database as db
from bot.bot import bot
from configs.configs import CHAT_CIRCLE_ID
from filters.filters import worked_fight

from configs.configs import __version__

text = '''
<b>–ê—Å—Å–∞–ª–∞–º –∞–ª–µ–π–∫—É–º, {user}!</b>

<b><u>–ö—Ä—É–≥ –∫—Ä–æ–≤–∏</u></b>

–ö–æ–≥–¥–∞? –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 17:30 –ú–°–ö

–ó–∞—á–µ–º? –≠—Ç–æ –æ–±—â–µ–≥–æ—Ä–æ–¥—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ. –í–æ–∑–º–æ–∂–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ - 3 –¥—Ä–µ–≤–Ω–∏–µ –º–æ–Ω–µ—Ç—ã –∏ –±–∞—Ñ—Ñ -20% –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ —Å—É—Ç–∫–∏.

–ß—Ç–æ –¥–µ–ª–∞—Ç—å? 
–ü—Ä–∏–¥—Ç–∏ –≤ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–µ–º–ª–∏ -5 -7 –¥–æ 17:30 –ú–°–ö.
–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –±–∏—Ç–≤—É
ü©∏  –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å
–ù–µ —Å—Ö–æ–¥–∏—Ç—å —Å —Ç–æ—á–∫–∏ –¥–æ –∫–æ–Ω—Ü–∞ –±–∏—Ç–≤—ã.
–ë–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —á–∞—Ç–µ –ë–æ–∏ –Ω–∞ –≥–∏–ø–µ—Ä–∏–æ–Ω–µ

–°—Ç—Ä–∞—Ç–µ–≥–∏—è. 
–ï—Å—Ç—å 2 –≤–æ–∑–º–æ–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è: —É–¥–∞—Ä–∏—Ç—å –∏–ª–∏ –ø—Ä–∏–∫—Ä—ã—Ç—å. –í—ã–±–∏—Ä–∞–π –≤—Ç–æ—Ä–æ–µ, –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –Ω–∞ —Ç–µ–±—è –∏–ª–∏ —Ç–≤–æ–µ–≥–æ —Å–æ—é–∑–Ω–∏–∫–∞ —Å–µ–π—á–∞—Å –Ω–∞–ø–∞–¥—É—Ç, –ª–∏–±–æ —É–¥–∞—Ä–∏—Ç—å, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞. –ú–∞–≥–∏—è –≤ –∫—Ä—É–≥–µ –∫—Ä–æ–≤–∏ –Ω–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç.
–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∏–≥—Ä–æ–∫–∞–º–∏
–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –±–∏—Ç–≤—ã –∏–º–µ—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ –∏–º–µ–Ω–∞. –¢—ã —É–∑–Ω–∞–µ—à—å —Å–≤–æ—ë –∏–º—è –Ω–∞—á–∏–Ω–∞—è —Å 1 —Ä–∞—É–Ω–¥–∞. –ü–µ—Ä–µ—à–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å "–†–∞—É–Ω–¥" –≤ –≥–æ—Ä–æ–¥—Å–∫–æ–π —á–∞—Ç –ö—Ä—É–≥ –∫—Ä–æ–≤–∏, —á—Ç–æ–±—ã —Å–æ—é–∑–Ω–∏–∫–∏ —Å–∫–æ—Ä–µ–µ —É–∑–Ω–∞–ª–∏ –∫—Ç–æ —Å–≤–æ–π, –∞ –∫—Ç–æ –Ω–∞—à –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫.

–° –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º —Ä–∞—É–Ω–¥–æ–º –≤ —á–∞—Ç–µ –ö—Ä—É–≥ –∫—Ä–æ–≤–∏ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤, –≤–∏–¥–∞

–°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤:
(4) üõ°: <code>2 üî™ ‚û°Ô∏è üï≥ –ë—Ä–æ–Ω–∑–æ–≤—ã–π</code>
(4) üõ°: <code>2 üî™ ‚û°Ô∏è üï≥ –î–µ—Ä–∑–∫–∏–π</code>
 
(4) - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞—Ä–æ–≤ –¥–ª—è —É–±–∏–π—Å—Ç–≤–∞.
2üõ° - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —â–∏—Ç–æ–≤ –Ω–∞ –±–æ–π. –ú–∞–∫—Å–∏–º—É–º 2 —â–∏—Ç–∞ –Ω–∞ –≤–µ—Å—å –±–æ–π
üî™ ‚û°Ô∏è üï≥ –ë—Ä–æ–Ω–∑–æ–≤—ã–π  - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∞—Ç–∞–∫–∏ (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞-—Å–∫–æ–ø–∏—Ä—É–π –∫–æ–º–∞–Ω–¥—É –Ω–∞ —É–±–∏–π—Å—Ç–≤–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —á–∞—Ç  –ë–æ–∏ –Ω–∞ –ì–∏–ø–µ—Ä–∏–æ–Ω–µ) 

–ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤—Å–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∏ –±—É–¥—É—Ç –ø–æ–≤–µ—Ä–∂–µ–Ω—ã, –±–æ—Ç —Ä–∞—Å–∫—Ä–æ–µ—Ç –∏–º–µ–Ω–∞ —Å–æ—é–∑–Ω–∏–∫–æ–≤ –∏ —É–∫–∞–∂–µ—Ç –∏–º—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è. 

(3) –ú–∞—Ä–∏—è <code>üî™ ‚û°Ô∏è üï≥ –ó–æ–ª–æ—Ç–æ–π</code>

–ü–æ–±–µ–¥–∏—Ç–µ–ª—å:
(3) –¢–∞—Ç—å—è–Ω–∞ / üõ°: 2 <code>üõ° –ü—Ä–∏–∫—Ä—ã—Ç—å ‚û°Ô∏è üï≥ –ß—ë—Ç–∫–∏–π</code>

–° —ç—Ç–æ–≥–æ —Ä–∞—É–Ω–¥–∞ –±–µ–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å –≤–µ—Ä—Ö–Ω–µ–≥–æ —Å–ø–∏—Å–∫–∞ –∏ –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞—â–∏—â–∞–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
'''


@bot.on_message(
    filters.private &
    filters.command("start") &
    ~worked_fight()
)
async def test(client, message):
    private_status =  (await db.get_user(message.from_user.id, "permission_private"))[0]
    if not private_status:
        await message.reply("–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø.")
    else:
        await message.reply("–°–∞–ª–∞–º!")


@bot.on_message(
    filters.new_chat_members &
    filters.chat(CHAT_CIRCLE_ID) &
    ~worked_fight()
)
async def test(client, message):
    await message.reply(text.format(user=message.new_chat_members[0].mention()))
    
    if not message.new_chat_members[0].is_bot:
        await db.new_user(message.new_chat_members[0].id)


@bot.on_message(
    filters.command("help") &
    filters.chat(CHAT_CIRCLE_ID) &
    ~worked_fight()
)
@db.update_time
async def test(client, message):
    await message.reply(text.format(user=message.from_user.mention()))


@bot.on_message(
    filters.command(["version", "v"]) &
    filters.chat(CHAT_CIRCLE_ID) &
    ~worked_fight()
)
@db.update_time
async def test(client, message):
    await message.reply(f"<b>v{__version__}</b>")
